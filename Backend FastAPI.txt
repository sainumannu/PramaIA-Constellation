INFO:     Will watch for changes in these directories: ['C:\\PramaIA\\PramaIAServer']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [20168] using WatchFiles
INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [4892]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x000001F7F8B27C40>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001F7F8B27C40> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00035s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x1f7d58616a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('name', operator.itemgetter(3)), ('id', operator.itemgetter(0)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('username', operator.itemgetter(1)), ('email', operator.itemgetter(2)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x1f7d5380af0; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001F7F8B27C40> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001F7F8B27C40> rollback-on-return
INFO:     Application startup complete.
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 1075
INFO:backend.routers.plugins_router:Plugin registrato: PDF Folder Monitor (pdf-monitor-001) su http://localhost:8001
INFO:     127.0.0.1:60895 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
INFO:     127.0.0.1:60897 - "GET /api/folders/state?path=D%3A/TestPramaIA HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:60899 - "POST /api/document-monitor/upload/ HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:65407 - "POST /api/document-monitor/upload/ HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:65410 - "POST /api/document-monitor/upload/ HTTP/1.1" 404 Not Found
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001F7F8B27C40> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 42.15s ago] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: User 'admin' found in database. ID: 1. Proceeding to verify password.
DEBUG:backend.services.user_service:USER_SERVICE: Verifying password for user 'admin'
WARNING:passlib.handlers.bcrypt:(trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
DEBUG:passlib.handlers.bcrypt:detected 'bcrypt' backend, version '<unknown>'
DEBUG:passlib.handlers.bcrypt:'bcrypt' backend lacks $2$ support, enabling workaround
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
INFO:backend.services.user_service:USER_SERVICE: User 'admin' authenticated successfully.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001F7F8B27C40> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001F7F8B27C40> rollback-on-return
INFO:     127.0.0.1:61546 - "POST /auth/token/local HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 99
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdW...
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token estratto: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...OzYD5LH4OA (lunghezza: 191)
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token decodificato con successo. Payload: {'sub': 'admin', 'name': 'Administrator', 'role': 'admin', 'user_id': 1, 'exp': 1763596505}
INFO:vectorstore_client:VectorstoreServiceClient inizializzato con URL: http://localhost:8090
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8090
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health/ HTTP/1.1" 200 15
INFO:vectorstore_client:Connessione a VectorstoreService stabilita: http://localhost:8090
ERROR:backend.core.rag_engine:Errore ingest_pdf per file 'test_e2e_upload.pdf': 'VectorstoreServiceClient' object has no attribute 'add_documents'
Traceback (most recent call last):
  File "C:\PramaIA\PramaIAServer\backend\core\rag_engine.py", line 76, in ingest_pdf
    response = client.add_documents(collection_name, doc_texts, metadatas)
               ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VectorstoreServiceClient' object has no attribute 'add_documents'. Did you mean: 'add_document'?
INFO:backend.services.document_service:Attempting to save metadata for: test_e2e_upload.pdf, owner: 1, size: 1678 bytes, is_public: False
DEBUG:backend.services.document_service:DATA_INDEX_PATH is: C:\PramaIA\PramaIAServer\backend\db\index.json
INFO:backend.services.document_service:Loaded 7 existing entries from C:\PramaIA\PramaIAServer\backend\db\index.json.
INFO:backend.services.document_service:Removed existing entry for 'test_e2e_upload.pdf' during deduplication.
INFO:backend.services.document_service:Appended new entry for 'test_e2e_upload.pdf'. Total entries now: 7.
INFO:backend.services.document_service:Successfully wrote 7 entries to C:\PramaIA\PramaIAServer\backend\db\index.json.

================================================================================
üî¥ [emit_event] FUNCTION CALLED!
   event_type: file_upload
   source: web-client-upload
   user_id: 1
   data keys: ['filename', 'file_size', 'content_type', 'user_id', 'is_public']
================================================================================

üü° [emit_event] Validating inputs...
üü° [emit_event] Input validation passed
üü° [emit_event] Building metadata...
INFO:     127.0.0.1:62903 - "POST /api/documents/upload-with-visibility/ HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 451
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:57374 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend\routers\documents_router.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [4892]
INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [31760]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x000001A842DB7E20>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001A842DB7E20> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x1a81fb016a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('name', operator.itemgetter(3)), ('id', operator.itemgetter(0)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('username', operator.itemgetter(1)), ('email', operator.itemgetter(2)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x1a81f620af0; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001A842DB7E20> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001A842DB7E20> rollback-on-return
INFO:     Application startup complete.
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
WARNING:  WatchFiles detected changes in 'backend\routers\documents_router.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [31760]
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 1075
INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [31844]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x000001D1D5243E20>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001D1D5243E20> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00023s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x1d1b1f616a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('id', operator.itemgetter(0)), ('name', operator.itemgetter(3)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('email', operator.itemgetter(2)), ('username', operator.itemgetter(1)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x1d1b1a80af0; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001D1D5243E20> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001D1D5243E20> rollback-on-return
INFO:     Application startup complete.
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 1075
INFO:backend.routers.plugins_router:Plugin registrato: PDF Folder Monitor (pdf-monitor-001) su http://localhost:8001
INFO:     127.0.0.1:50213 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001D1D5243E20> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 38.52s ago] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: User 'admin' found in database. ID: 1. Proceeding to verify password.
DEBUG:backend.services.user_service:USER_SERVICE: Verifying password for user 'admin'
WARNING:passlib.handlers.bcrypt:(trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
DEBUG:passlib.handlers.bcrypt:detected 'bcrypt' backend, version '<unknown>'
DEBUG:passlib.handlers.bcrypt:'bcrypt' backend lacks $2$ support, enabling workaround
INFO:backend.services.user_service:USER_SERVICE: User 'admin' authenticated successfully.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001D1D5243E20> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001D1D5243E20> rollback-on-return
INFO:     127.0.0.1:50222 - "POST /auth/token/local HTTP/1.1" 200 OK
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdW...
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token estratto: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...2zlQ9qmWCA (lunghezza: 191)
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token decodificato con successo. Payload: {'sub': 'admin', 'name': 'Administrator', 'role': 'admin', 'user_id': 1, 'exp': 1763596606}
INFO:vectorstore_client:VectorstoreServiceClient inizializzato con URL: http://localhost:8090
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8090
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health/ HTTP/1.1" 200 15
INFO:vectorstore_client:Connessione a VectorstoreService stabilita: http://localhost:8090
ERROR:backend.core.rag_engine:Errore ingest_pdf per file 'test_e2e_upload.pdf': 'VectorstoreServiceClient' object has no attribute 'add_documents'
Traceback (most recent call last):
  File "C:\PramaIA\PramaIAServer\backend\core\rag_engine.py", line 76, in ingest_pdf
    response = client.add_documents(collection_name, doc_texts, metadatas)
               ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VectorstoreServiceClient' object has no attribute 'add_documents'. Did you mean: 'add_document'?
INFO:backend.services.document_service:Attempting to save metadata for: test_e2e_upload.pdf, owner: 1, size: 1678 bytes, is_public: False
DEBUG:backend.services.document_service:DATA_INDEX_PATH is: C:\PramaIA\PramaIAServer\backend\db\index.json
INFO:backend.services.document_service:Loaded 7 existing entries from C:\PramaIA\PramaIAServer\backend\db\index.json.
INFO:backend.services.document_service:Removed existing entry for 'test_e2e_upload.pdf' during deduplication.
INFO:backend.services.document_service:Appended new entry for 'test_e2e_upload.pdf'. Total entries now: 7.
INFO:backend.services.document_service:Successfully wrote 7 entries to C:\PramaIA\PramaIAServer\backend\db\index.json.

================================================================================
üî¥ [emit_event] FUNCTION CALLED!
   event_type: file_upload
   source: web-client-upload
   user_id: 1
   data keys: ['filename', 'file_size', 'content_type', 'user_id', 'is_public']
================================================================================

üü° [emit_event] Validating inputs...
üü° [emit_event] Input validation passed
üü° [emit_event] Building metadata...
üü° [emit_event] Metadata built successfully
üü° [emit_event] Building payload...
üü° [emit_event] Payload built successfully

================================================================================
üü¢ [process_generic_event] CALLED!
   event_id: 290b559e-4c51-44b1-92af-35106a4196cb
   event_type: file_upload
   source: web-client-upload
   user_id: 1
================================================================================

INFO:backend.routers.event_trigger_system:üü¢ [process_generic_event] CALLED! event_type=file_upload, source=web-client-upload, event_id=290b559e-4c51-44b1-92af-35106a4196cb
INFO:backend.routers.event_trigger_system:Ricevuto evento file_upload da web-client-upload [ID: 290b559e-4c51-44b1-92af-35106a4196cb]
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 294
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato

================================================================================
üîµ [TriggerService.process_event] CALLED!
   event_type: file_upload
   data keys: ['filename', 'file_size', 'content_type', 'user_id', 'is_public']
   metadata: {'source': 'web-client-upload', 'timestamp': '2025-11-19T22:56:51.231664', 'user_id': '1', 'additional_data': {}}
================================================================================

INFO:backend.crud.workflow_triggers:üìä Accesso al DB per trigger: C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üìä Percorso completo DB: sqlite:///C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üîç Query per trigger: SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001D1D5243E20> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
INFO:sqlalchemy.engine.Engine:[generated in 0.00022s] ()
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'name', 'event_type', 'source', 'workflow_id', 'target_node_id', 'conditions', 'active', 'created_at', 'updated_at')
DEBUG:sqlalchemy.engine.Engine:Row ('2cf4add5-5fa5-485f-a8b1-549557b14955', 'Trigger Aggiunta PDF', 'pdf_file_added', 'pdf-monitor-event-source', 'wf_bd11290f923b', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 16, 21, 11, 1, 755526))
INFO:backend.crud.workflow_triggers:üîé Trigger 2cf4add5-5fa5-485f-a8b1-549557b14955: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a', 'Trigger Eliminazione PDF', 'document_file_deleted', 'pdf-monitor-event-source', 'wf_b32ead12131c', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 36, 44, 462354))
INFO:backend.crud.workflow_triggers:üîé Trigger 11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('f052f3b6-3bf2-4eda-bb2f-62486ee52893', 'Trigger Aggiornamento PDF', 'document_file_modified', 'pdf-monitor-event-source', 'wf_055bf5029833', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 37, 3, 623911))
INFO:backend.crud.workflow_triggers:üîé Trigger f052f3b6-3bf2-4eda-bb2f-62486ee52893: conditions={} (tipo: dict)
INFO:backend.crud.workflow_triggers:‚úÖ Trovati 3 trigger nel database
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 1: ID=2cf4add5-5fa5-485f-a8b1-549557b14955, Nome=Trigger Aggiunta PDF, Tipo=pdf_file_added, Workflow=wf_bd11290f923b
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 2: ID=11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a, Nome=Trigger Eliminazione PDF, Tipo=document_file_deleted, Workflow=wf_b32ead12131c
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 3: ID=f052f3b6-3bf2-4eda-bb2f-62486ee52893, Nome=Trigger Aggiornamento PDF, Tipo=document_file_modified, Workflow=wf_055bf5029833
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop nodes
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes setup primary join workflows.workflow_id = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes synchronize pairs [(workflows.workflow_id => workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes local/remote pairs [(workflows.workflow_id / workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes remote columns [workflow_nodes.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.nodes lazy loading clause :param_1 = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop connections
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections setup primary join workflows.workflow_id = workflow_connections.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections synchronize pairs [(workflows.workflow_id => workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections local/remote pairs [(workflows.workflow_id / workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections remote columns [workflow_connections.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.connections lazy loading clause :param_1 = workflow_connections.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop executions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions setup primary join workflows.workflow_id = workflow_executions.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions synchronize pairs [(workflows.workflow_id => workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions local/remote pairs [(workflows.workflow_id / workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions remote columns [workflow_executions.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.executions lazy loading clause :param_1 = workflow_executions.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop created_by
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop is_public
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop assigned_groups
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop tags
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop category
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop priority
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop color
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop view_state
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow setup primary join workflows.workflow_id = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow synchronize pairs [(workflows.workflow_id => workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow local/remote pairs [(workflow_nodes.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow local columns [workflow_nodes.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowNode.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop node_type
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop config
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop position
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop width
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop height
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop resizable
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop icon
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop color
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow setup primary join workflows.workflow_id = workflow_connections.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow synchronize pairs [(workflows.workflow_id => workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow local/remote pairs [(workflow_connections.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow local columns [workflow_connections.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowConnection.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop from_node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop to_node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop from_port
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop to_port
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow setup primary join workflows.workflow_id = workflow_executions.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow synchronize pairs [(workflows.workflow_id => workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow local/remote pairs [(workflow_executions.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow local columns [workflow_executions.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowExecution.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop execution_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop status
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop input_data
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop output_data
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop error_message
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop started_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop completed_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop execution_time_ms
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop event_type
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop source
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop conditions
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop active
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_type
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop source
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_data
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_metadata
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop triggers_matched
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop workflows_executed
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop success
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop error_message
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop processed_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) _post_configure_properties() complete
ERROR:backend.crud.workflow_triggers:‚ùå Error creating event log: 'data' is an invalid keyword argument for EventLog
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001D1D5243E20> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001D1D5243E20> rollback-on-return
INFO:     127.0.0.1:62920 - "POST /api/documents/upload-with-visibility/ HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 2713
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:57252 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend\crud\workflow_triggers.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [31844]
INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [17848]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x00000279BB457F10>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x2799819d6a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('id', operator.itemgetter(0)), ('name', operator.itemgetter(3)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('email', operator.itemgetter(2)), ('username', operator.itemgetter(1)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x27997cb9810; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> rollback-on-return
INFO:     Application startup complete.
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 1075
INFO:backend.routers.plugins_router:Plugin registrato: PDF Folder Monitor (pdf-monitor-001) su http://localhost:8001
INFO:     127.0.0.1:59616 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 21.78s ago] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: User 'admin' found in database. ID: 1. Proceeding to verify password.
DEBUG:backend.services.user_service:USER_SERVICE: Verifying password for user 'admin'
WARNING:passlib.handlers.bcrypt:(trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
DEBUG:passlib.handlers.bcrypt:detected 'bcrypt' backend, version '<unknown>'
DEBUG:passlib.handlers.bcrypt:'bcrypt' backend lacks $2$ support, enabling workaround
INFO:backend.services.user_service:USER_SERVICE: User 'admin' authenticated successfully.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> rollback-on-return
INFO:     127.0.0.1:59621 - "POST /auth/token/local HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 216
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdW...
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token estratto: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...oNRog5hJLY (lunghezza: 191)
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token decodificato con successo. Payload: {'sub': 'admin', 'name': 'Administrator', 'role': 'admin', 'user_id': 1, 'exp': 1763596723}
INFO:vectorstore_client:VectorstoreServiceClient inizializzato con URL: http://localhost:8090
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8090
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health/ HTTP/1.1" 200 15
INFO:vectorstore_client:Connessione a VectorstoreService stabilita: http://localhost:8090
ERROR:backend.core.rag_engine:Errore ingest_pdf per file 'test_e2e_upload.pdf': 'VectorstoreServiceClient' object has no attribute 'add_documents'
Traceback (most recent call last):
  File "C:\PramaIA\PramaIAServer\backend\core\rag_engine.py", line 76, in ingest_pdf
    response = client.add_documents(collection_name, doc_texts, metadatas)
               ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VectorstoreServiceClient' object has no attribute 'add_documents'. Did you mean: 'add_document'?
INFO:backend.services.document_service:Attempting to save metadata for: test_e2e_upload.pdf, owner: 1, size: 1679 bytes, is_public: False
DEBUG:backend.services.document_service:DATA_INDEX_PATH is: C:\PramaIA\PramaIAServer\backend\db\index.json
INFO:backend.services.document_service:Loaded 7 existing entries from C:\PramaIA\PramaIAServer\backend\db\index.json.
INFO:backend.services.document_service:Removed existing entry for 'test_e2e_upload.pdf' during deduplication.
INFO:backend.services.document_service:Appended new entry for 'test_e2e_upload.pdf'. Total entries now: 7.
INFO:backend.services.document_service:Successfully wrote 7 entries to C:\PramaIA\PramaIAServer\backend\db\index.json.

================================================================================
üî¥ [emit_event] FUNCTION CALLED!
   event_type: file_upload
   source: web-client-upload
   user_id: 1
   data keys: ['filename', 'file_size', 'content_type', 'user_id', 'is_public']
================================================================================

üü° [emit_event] Validating inputs...
üü° [emit_event] Input validation passed
üü° [emit_event] Building metadata...
üü° [emit_event] Metadata built successfully
üü° [emit_event] Building payload...
üü° [emit_event] Payload built successfully

================================================================================
üü¢ [process_generic_event] CALLED!
   event_id: a229158d-d987-4c2a-859b-9bdc93057dfc
   event_type: file_upload
   source: web-client-upload
   user_id: 1
================================================================================

INFO:backend.routers.event_trigger_system:üü¢ [process_generic_event] CALLED! event_type=file_upload, source=web-client-upload, event_id=a229158d-d987-4c2a-859b-9bdc93057dfc
INFO:backend.routers.event_trigger_system:Ricevuto evento file_upload da web-client-upload [ID: a229158d-d987-4c2a-859b-9bdc93057dfc]
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato

================================================================================
üîµ [TriggerService.process_event] CALLED!
   event_type: file_upload
   data keys: ['filename', 'file_size', 'content_type', 'user_id', 'is_public']
   metadata: {'source': 'web-client-upload', 'timestamp': '2025-11-19T22:58:47.609565', 'user_id': '1', 'additional_data': {}}
================================================================================

INFO:backend.crud.workflow_triggers:üìä Accesso al DB per trigger: C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üìä Percorso completo DB: sqlite:///C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üîç Query per trigger: SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
INFO:sqlalchemy.engine.Engine:[generated in 0.00016s] ()
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'name', 'event_type', 'source', 'workflow_id', 'target_node_id', 'conditions', 'active', 'created_at', 'updated_at')
DEBUG:sqlalchemy.engine.Engine:Row ('2cf4add5-5fa5-485f-a8b1-549557b14955', 'Trigger Aggiunta PDF', 'pdf_file_added', 'pdf-monitor-event-source', 'wf_bd11290f923b', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 16, 21, 11, 1, 755526))
INFO:backend.crud.workflow_triggers:üîé Trigger 2cf4add5-5fa5-485f-a8b1-549557b14955: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a', 'Trigger Eliminazione PDF', 'document_file_deleted', 'pdf-monitor-event-source', 'wf_b32ead12131c', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 36, 44, 462354))
INFO:backend.crud.workflow_triggers:üîé Trigger 11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('f052f3b6-3bf2-4eda-bb2f-62486ee52893', 'Trigger Aggiornamento PDF', 'document_file_modified', 'pdf-monitor-event-source', 'wf_055bf5029833', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 37, 3, 623911))
INFO:backend.crud.workflow_triggers:üîé Trigger f052f3b6-3bf2-4eda-bb2f-62486ee52893: conditions={} (tipo: dict)
INFO:backend.crud.workflow_triggers:‚úÖ Trovati 3 trigger nel database
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 1: ID=2cf4add5-5fa5-485f-a8b1-549557b14955, Nome=Trigger Aggiunta PDF, Tipo=pdf_file_added, Workflow=wf_bd11290f923b
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 2: ID=11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a, Nome=Trigger Eliminazione PDF, Tipo=document_file_deleted, Workflow=wf_b32ead12131c
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 3: ID=f052f3b6-3bf2-4eda-bb2f-62486ee52893, Nome=Trigger Aggiornamento PDF, Tipo=document_file_modified, Workflow=wf_055bf5029833
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop nodes
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes setup primary join workflows.workflow_id = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes synchronize pairs [(workflows.workflow_id => workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes local/remote pairs [(workflows.workflow_id / workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes remote columns [workflow_nodes.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.nodes lazy loading clause :param_1 = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop connections
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections setup primary join workflows.workflow_id = workflow_connections.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections synchronize pairs [(workflows.workflow_id => workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections local/remote pairs [(workflows.workflow_id / workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections remote columns [workflow_connections.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.connections lazy loading clause :param_1 = workflow_connections.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop executions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions setup primary join workflows.workflow_id = workflow_executions.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions synchronize pairs [(workflows.workflow_id => workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions local/remote pairs [(workflows.workflow_id / workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions remote columns [workflow_executions.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.executions lazy loading clause :param_1 = workflow_executions.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop created_by
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop is_public
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop assigned_groups
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop tags
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop category
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop priority
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop color
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop view_state
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow setup primary join workflows.workflow_id = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow synchronize pairs [(workflows.workflow_id => workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow local/remote pairs [(workflow_nodes.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow local columns [workflow_nodes.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowNode.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop node_type
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop config
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop position
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop width
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop height
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop resizable
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop icon
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop color
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow setup primary join workflows.workflow_id = workflow_connections.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow synchronize pairs [(workflows.workflow_id => workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow local/remote pairs [(workflow_connections.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow local columns [workflow_connections.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowConnection.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop from_node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop to_node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop from_port
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop to_port
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow setup primary join workflows.workflow_id = workflow_executions.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow synchronize pairs [(workflows.workflow_id => workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow local/remote pairs [(workflow_executions.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow local columns [workflow_executions.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowExecution.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop execution_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop status
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop input_data
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop output_data
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop error_message
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop started_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop completed_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop execution_time_ms
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop event_type
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop source
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop conditions
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop active
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_type
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop source
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_data
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_metadata
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop triggers_matched
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop workflows_executed
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop success
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop error_message
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop processed_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) _post_configure_properties() complete
INFO:sqlalchemy.engine.Engine:INSERT INTO event_logs (event_type, source, event_data, triggers_matched, workflows_executed, success, error_message) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id, processed_at
INFO:sqlalchemy.engine.Engine:[generated in 0.00022s] ('file_upload', 'web-client-upload', '{"filename": "test_e2e_upload.pdf", "file_size": 1679, "content_type": "application/pdf", "user_id": 1, "is_public": false}', 0, 0, 1, None)
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'processed_at')
DEBUG:sqlalchemy.engine.Engine:Row (1, datetime.datetime(2025, 11, 19, 22, 58, 48))
INFO:sqlalchemy.engine.Engine:COMMIT
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> rollback-on-return
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[EventLog(event_logs)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT event_logs.id, event_logs.event_type, event_logs.source, event_logs.event_data, event_logs.event_metadata, event_logs.triggers_matched, event_logs.workflows_executed, event_logs.success, event_logs.error_message, event_logs.processed_at
FROM event_logs
WHERE event_logs.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00017s] (1,)
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'event_type', 'source', 'event_data', 'event_metadata', 'triggers_matched', 'workflows_executed', 'success', 'error_message', 'processed_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x279ba331450; EventLog>)' on path 'ORM Path[Mapper[EventLog(event_logs)]]' to '{'cached_populators': {'new': [], 'quick': [('event_data', operator.itemgetter(3)), ('id', operator.itemgetter(0)), ('triggers_matched', operator.itemgetter(5)), ('success', operator.itemgetter(7)), ('processed_at', operator.itemgetter(9)), ('event_metadata', operator.itemgetter(4)), ('event_type', operator.itemgetter(1)),('source', operator.itemgetter(2)), ('workflows_executed', operator.itemgetter(6)), ('error_message', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [], 'primary_key_getter': None}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'file_upload', 'web-client-upload', {'filename': 'test_e2e_upload.pdf', 'file_size': 1679, 'content_type': 'application/pdf', 'user_id': 1, 'is_public': False}, None, 0, 0, True, None, datetime.datetime(2025, 11, 19, 22, 58, 48))
INFO:backend.crud.workflow_triggers:‚úÖ Event log created: 1
ERROR:backend.crud.workflow_triggers:‚ùå Error creating event log: 'EventLog' object has no attribute 'created_at'
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> rollback-on-return
INFO:     127.0.0.1:59626 - "POST /api/documents/upload-with-visibility/ HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 2791
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 76.86s ago] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: User 'admin' found in database. ID: 1. Proceeding to verify password.
DEBUG:backend.services.user_service:USER_SERVICE: Verifying password for user 'admin'
INFO:backend.services.user_service:USER_SERVICE: User 'admin' authenticated successfully.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> rollback-on-return
INFO:     127.0.0.1:65135 - "POST /auth/token/local HTTP/1.1" 200 OK
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:65136 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdW...
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token estratto: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...cvaKrHesT0 (lunghezza: 191)
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token decodificato con successo. Payload: {'sub': 'admin', 'name': 'Administrator', 'role': 'admin', 'user_id': 1, 'exp': 1763596778}
INFO:vectorstore_client:VectorstoreServiceClient inizializzato con URL: http://localhost:8090
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8090
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health/ HTTP/1.1" 200 15
INFO:vectorstore_client:Connessione a VectorstoreService stabilita: http://localhost:8090
ERROR:backend.core.rag_engine:Errore ingest_pdf per file 'test_e2e_upload.pdf': 'VectorstoreServiceClient' object has no attribute 'add_documents'
Traceback (most recent call last):
  File "C:\PramaIA\PramaIAServer\backend\core\rag_engine.py", line 76, in ingest_pdf
    response = client.add_documents(collection_name, doc_texts, metadatas)
               ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VectorstoreServiceClient' object has no attribute 'add_documents'. Did you mean: 'add_document'?
INFO:backend.services.document_service:Attempting to save metadata for: test_e2e_upload.pdf, owner: 1, size: 1679 bytes, is_public: False
DEBUG:backend.services.document_service:DATA_INDEX_PATH is: C:\PramaIA\PramaIAServer\backend\db\index.json
INFO:backend.services.document_service:Loaded 7 existing entries from C:\PramaIA\PramaIAServer\backend\db\index.json.
INFO:backend.services.document_service:Removed existing entry for 'test_e2e_upload.pdf' during deduplication.
INFO:backend.services.document_service:Appended new entry for 'test_e2e_upload.pdf'. Total entries now: 7.
INFO:backend.services.document_service:Successfully wrote 7 entries to C:\PramaIA\PramaIAServer\backend\db\index.json.

================================================================================
üî¥ [emit_event] FUNCTION CALLED!
   event_type: file_upload
   source: web-client-upload
   user_id: 1
   data keys: ['filename', 'file_size', 'content_type', 'user_id', 'is_public']
================================================================================

üü° [emit_event] Validating inputs...
üü° [emit_event] Input validation passed
üü° [emit_event] Building metadata...
üü° [emit_event] Metadata built successfully
üü° [emit_event] Building payload...
üü° [emit_event] Payload built successfully

================================================================================
üü¢ [process_generic_event] CALLED!
   event_id: fe6db1be-68a8-4c4e-a236-6f4ff7946a57
   event_type: file_upload
   source: web-client-upload
   user_id: 1
================================================================================

INFO:backend.routers.event_trigger_system:üü¢ [process_generic_event] CALLED! event_type=file_upload, source=web-client-upload, event_id=fe6db1be-68a8-4c4e-a236-6f4ff7946a57
INFO:backend.routers.event_trigger_system:Ricevuto evento file_upload da web-client-upload [ID: fe6db1be-68a8-4c4e-a236-6f4ff7946a57]
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato

================================================================================
üîµ [TriggerService.process_event] CALLED!
   event_type: file_upload
   data keys: ['filename', 'file_size', 'content_type', 'user_id', 'is_public']
   metadata: {'source': 'web-client-upload', 'timestamp': '2025-11-19T22:59:42.507217', 'user_id': '1', 'additional_data': {}}
================================================================================

INFO:backend.crud.workflow_triggers:üìä Accesso al DB per trigger: C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üìä Percorso completo DB: sqlite:///C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üîç Query per trigger: SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
INFO:sqlalchemy.engine.Engine:[cached since 54.97s ago] ()
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'name', 'event_type', 'source', 'workflow_id', 'target_node_id', 'conditions', 'active', 'created_at', 'updated_at')
DEBUG:sqlalchemy.engine.Engine:Row ('2cf4add5-5fa5-485f-a8b1-549557b14955', 'Trigger Aggiunta PDF', 'pdf_file_added', 'pdf-monitor-event-source', 'wf_bd11290f923b', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 16, 21, 11, 1, 755526))
INFO:backend.crud.workflow_triggers:üîé Trigger 2cf4add5-5fa5-485f-a8b1-549557b14955: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a', 'Trigger Eliminazione PDF', 'document_file_deleted', 'pdf-monitor-event-source', 'wf_b32ead12131c', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 36, 44, 462354))
INFO:backend.crud.workflow_triggers:üîé Trigger 11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('f052f3b6-3bf2-4eda-bb2f-62486ee52893', 'Trigger Aggiornamento PDF', 'document_file_modified', 'pdf-monitor-event-source', 'wf_055bf5029833', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 37, 3, 623911))
INFO:backend.crud.workflow_triggers:üîé Trigger f052f3b6-3bf2-4eda-bb2f-62486ee52893: conditions={} (tipo: dict)
INFO:backend.crud.workflow_triggers:‚úÖ Trovati 3 trigger nel database
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 1: ID=2cf4add5-5fa5-485f-a8b1-549557b14955, Nome=Trigger Aggiunta PDF, Tipo=pdf_file_added, Workflow=wf_bd11290f923b
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 2: ID=11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a, Nome=Trigger Eliminazione PDF, Tipo=document_file_deleted, Workflow=wf_b32ead12131c
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 3: ID=f052f3b6-3bf2-4eda-bb2f-62486ee52893, Nome=Trigger Aggiornamento PDF, Tipo=document_file_modified, Workflow=wf_055bf5029833
INFO:sqlalchemy.engine.Engine:INSERT INTO event_logs (event_type, source, event_data, triggers_matched, workflows_executed, success, error_message) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id, processed_at
INFO:sqlalchemy.engine.Engine:[cached since 54.94s ago] ('file_upload', 'web-client-upload', '{"filename": "test_e2e_upload.pdf", "file_size": 1679, "content_type": "application/pdf", "user_id": 1, "is_public": false}', 0, 0, 1, None)
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'processed_at')
DEBUG:sqlalchemy.engine.Engine:Row (2, datetime.datetime(2025, 11, 19, 22, 59, 43))
INFO:sqlalchemy.engine.Engine:COMMIT
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> rollback-on-return
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_logs.id, event_logs.event_type, event_logs.source, event_logs.event_data, event_logs.event_metadata, event_logs.triggers_matched, event_logs.workflows_executed, event_logs.success, event_logs.error_message, event_logs.processed_at
FROM event_logs
WHERE event_logs.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 54.95s ago] (2,)
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'event_type', 'source', 'event_data', 'event_metadata', 'triggers_matched', 'workflows_executed', 'success', 'error_message', 'processed_at')
DEBUG:sqlalchemy.engine.Engine:Row (2, 'file_upload', 'web-client-upload', {'filename': 'test_e2e_upload.pdf', 'file_size': 1679, 'content_type': 'application/pdf', 'user_id': 1, 'is_public': False}, None, 0, 0, True, None, datetime.datetime(2025, 11, 19, 22, 59, 43))
INFO:backend.crud.workflow_triggers:‚úÖ Event log created: 2
ERROR:backend.crud.workflow_triggers:‚ùå Error creating event log: 'EventLog' object has no attribute 'created_at'
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000279BB457F10> rollback-on-return
INFO:     127.0.0.1:65138 - "POST /api/documents/upload-with-visibility/ HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 294
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 2713
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:56878 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:60269 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend\services\trigger_service.py', 'backend\services\event_emitter.py', 'backend\crud\workflow_triggers.py', 'backend\routers\event_trigger_system.py', 'backend\routers\documents_router.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [17848]
INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [16704]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x0000020D0519FE20>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000020D0519FE20> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x20d61cd16a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('id', operator.itemgetter(0)), ('name', operator.itemgetter(3)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('email', operator.itemgetter(2)), ('username', operator.itemgetter(1)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x20d617e9810; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000020D0519FE20> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000020D0519FE20> rollback-on-return
INFO:     Application startup complete.
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 1075
WARNING:  WatchFiles detected changes in 'backend\services\event_emitter.py', 'backend\routers\documents_router.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [16704]
INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [25780]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x0000023367F5FB50>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000023367F5FB50> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00020s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x23344ca16a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('id', operator.itemgetter(0)), ('name', operator.itemgetter(3)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('username', operator.itemgetter(1)), ('email', operator.itemgetter(2)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x233447c0af0; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000023367F5FB50> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000023367F5FB50> rollback-on-return
INFO:     Application startup complete.
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 1075
WARNING:  WatchFiles detected changes in 'backend\routers\event_trigger_system.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [25780]
WARNING:  WatchFiles detected changes in 'backend\services\trigger_service.py'. Reloading...
 INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [2604]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x000001C8C931BB50>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001C8C931BB50> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00029s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x1c8a5f616a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('name', operator.itemgetter(3)), ('id', operator.itemgetter(0)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('username', operator.itemgetter(1)), ('email', operator.itemgetter(2)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x1c8a5a80af0; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001C8C931BB50> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x000001C8C931BB50> rollback-on-return
INFO:     Application startup complete.
ERROR:    Traceback (most recent call last):
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 719, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 701, in lifespan
    await receive()
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [28288]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x00000231713EBB50>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000231713EBB50> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00021s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x2314e0116a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('id', operator.itemgetter(0)), ('name', operator.itemgetter(3)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('email', operator.itemgetter(2)), ('username', operator.itemgetter(1)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x2314db30af0; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000231713EBB50> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000231713EBB50> rollback-on-return
INFO:     Application startup complete.
INFO:backend.routers.plugins_router:Plugin registrato: PDF Folder Monitor (pdf-monitor-001) su http://localhost:8001
INFO:     127.0.0.1:51724 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 1075
WARNING:  WatchFiles detected changes in 'backend\services\trigger_service.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [28288]
INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [16668]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x0000029C2612BC40>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00021s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x29c02df16a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('id', operator.itemgetter(0)), ('name', operator.itemgetter(3)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('email', operator.itemgetter(2)), ('username', operator.itemgetter(1)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x29c02910af0; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> rollback-on-return
INFO:     Application startup complete.
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 1075
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 14.88s ago] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: User 'admin' found in database. ID: 1. Proceeding to verify password.
DEBUG:backend.services.user_service:USER_SERVICE: Verifying password for user 'admin'
WARNING:passlib.handlers.bcrypt:(trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
DEBUG:passlib.handlers.bcrypt:detected 'bcrypt' backend, version '<unknown>'
DEBUG:passlib.handlers.bcrypt:'bcrypt' backend lacks $2$ support, enabling workaround
INFO:backend.services.user_service:USER_SERVICE: User 'admin' authenticated successfully.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> rollback-on-return
INFO:     127.0.0.1:60806 - "POST /auth/token/local HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdW...
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token estratto: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...321qHShblU (lunghezza: 191)
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token decodificato con successo. Payload: {'sub': 'admin', 'name': 'Administrator', 'role': 'admin', 'user_id': 1, 'exp': 1763597030}
INFO:vectorstore_client:VectorstoreServiceClient inizializzato con URL: http://localhost:8090
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8090
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 216
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health/ HTTP/1.1" 200 15
INFO:vectorstore_client:Connessione a VectorstoreService stabilita: http://localhost:8090
ERROR:backend.core.rag_engine:Errore ingest_pdf per file 'test_e2e_upload.pdf': 'VectorstoreServiceClient' object has no attribute 'add_documents'
Traceback (most recent call last):
  File "C:\PramaIA\PramaIAServer\backend\core\rag_engine.py", line 76, in ingest_pdf
    response = client.add_documents(collection_name, doc_texts, metadatas)
               ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VectorstoreServiceClient' object has no attribute 'add_documents'. Did you mean: 'add_document'?
INFO:backend.services.document_service:Attempting to save metadata for: test_e2e_upload.pdf, owner: 1, size: 1678 bytes, is_public: False
DEBUG:backend.services.document_service:DATA_INDEX_PATH is: C:\PramaIA\PramaIAServer\backend\db\index.json
INFO:backend.services.document_service:Loaded 7 existing entries from C:\PramaIA\PramaIAServer\backend\db\index.json.
INFO:backend.services.document_service:Removed existing entry for 'test_e2e_upload.pdf' during deduplication.
INFO:backend.services.document_service:Appended new entry for 'test_e2e_upload.pdf'. Total entries now: 7.
INFO:backend.services.document_service:Successfully wrote 7 entries to C:\PramaIA\PramaIAServer\backend\db\index.json.
INFO:backend.routers.event_trigger_system:Ricevuto evento file_upload da web-client-upload [ID: 34cf9eaf-617c-473b-b9ee-8c237f18b34b]
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.crud.workflow_triggers:üìä Accesso al DB per trigger: C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üìä Percorso completo DB: sqlite:///C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üîç Query per trigger: SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
INFO:sqlalchemy.engine.Engine:[generated in 0.00017s] ()
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'name', 'event_type', 'source', 'workflow_id', 'target_node_id', 'conditions', 'active', 'created_at', 'updated_at')
DEBUG:sqlalchemy.engine.Engine:Row ('2cf4add5-5fa5-485f-a8b1-549557b14955', 'Trigger Aggiunta PDF', 'pdf_file_added', 'pdf-monitor-event-source', 'wf_bd11290f923b', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 16, 21, 11, 1, 755526))
INFO:backend.crud.workflow_triggers:üîé Trigger 2cf4add5-5fa5-485f-a8b1-549557b14955: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a', 'Trigger Eliminazione PDF', 'document_file_deleted', 'pdf-monitor-event-source', 'wf_b32ead12131c', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 36, 44, 462354))
INFO:backend.crud.workflow_triggers:üîé Trigger 11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('f052f3b6-3bf2-4eda-bb2f-62486ee52893', 'Trigger Aggiornamento PDF', 'document_file_modified', 'pdf-monitor-event-source', 'wf_055bf5029833', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 37, 3, 623911))
INFO:backend.crud.workflow_triggers:üîé Trigger f052f3b6-3bf2-4eda-bb2f-62486ee52893: conditions={} (tipo: dict)
INFO:backend.crud.workflow_triggers:‚úÖ Trovati 3 trigger nel database
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 1: ID=2cf4add5-5fa5-485f-a8b1-549557b14955, Nome=Trigger Aggiunta PDF, Tipo=pdf_file_added, Workflow=wf_bd11290f923b
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 2: ID=11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a, Nome=Trigger Eliminazione PDF, Tipo=document_file_deleted, Workflow=wf_b32ead12131c
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 3: ID=f052f3b6-3bf2-4eda-bb2f-62486ee52893, Nome=Trigger Aggiornamento PDF, Tipo=document_file_modified, Workflow=wf_055bf5029833
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop nodes
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes setup primary join workflows.workflow_id = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes synchronize pairs [(workflows.workflow_id => workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes local/remote pairs [(workflows.workflow_id / workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes remote columns [workflow_nodes.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.nodes lazy loading clause :param_1 = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop connections
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections setup primary join workflows.workflow_id = workflow_connections.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections synchronize pairs [(workflows.workflow_id => workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections local/remote pairs [(workflows.workflow_id / workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections remote columns [workflow_connections.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.connections lazy loading clause :param_1 = workflow_connections.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop executions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions setup primary join workflows.workflow_id = workflow_executions.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions synchronize pairs [(workflows.workflow_id => workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions local/remote pairs [(workflows.workflow_id / workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions remote columns [workflow_executions.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.executions lazy loading clause :param_1 = workflow_executions.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop created_by
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop is_public
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop assigned_groups
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop tags
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop category
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop priority
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop color
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop view_state
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow setup primary join workflows.workflow_id = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow synchronize pairs [(workflows.workflow_id => workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow local/remote pairs [(workflow_nodes.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow local columns [workflow_nodes.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowNode.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop node_type
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop config
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop position
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop width
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop height
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop resizable
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop icon
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop color
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow setup primary join workflows.workflow_id = workflow_connections.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow synchronize pairs [(workflows.workflow_id => workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow local/remote pairs [(workflow_connections.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow local columns [workflow_connections.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowConnection.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop from_node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop to_node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop from_port
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop to_port
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow setup primary join workflows.workflow_id = workflow_executions.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow synchronize pairs [(workflows.workflow_id => workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow local/remote pairs [(workflow_executions.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow local columns [workflow_executions.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowExecution.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop execution_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop status
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop input_data
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop output_data
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop error_message
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop started_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop completed_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop execution_time_ms
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop event_type
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop source
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop conditions
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop active
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_type
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop source
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_data
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_metadata
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop triggers_matched
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop workflows_executed
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop success
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop error_message
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop processed_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) _post_configure_properties() complete
INFO:sqlalchemy.engine.Engine:INSERT INTO event_logs (event_type, source, event_data, triggers_matched, workflows_executed, success, error_message) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id, processed_at
INFO:sqlalchemy.engine.Engine:[generated in 0.00029s] ('file_upload', 'web-client-upload', '{"filename": "test_e2e_upload.pdf", "file_size": 1678, "content_type": "application/pdf", "user_id": 1, "is_public": false}', 0, 0, 1, None)
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'processed_at')
DEBUG:sqlalchemy.engine.Engine:Row (3, datetime.datetime(2025, 11, 19, 23, 3, 56))
INFO:sqlalchemy.engine.Engine:COMMIT
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> rollback-on-return
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[EventLog(event_logs)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT event_logs.id, event_logs.event_type, event_logs.source, event_logs.event_data, event_logs.event_metadata, event_logs.triggers_matched, event_logs.workflows_executed, event_logs.success, event_logs.error_message, event_logs.processed_at
FROM event_logs
WHERE event_logs.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00017s] (3,)
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'event_type', 'source', 'event_data', 'event_metadata', 'triggers_matched', 'workflows_executed', 'success', 'error_message', 'processed_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x29c24f8d450; EventLog>)' on path 'ORM Path[Mapper[EventLog(event_logs)]]' to '{'cached_populators': {'new': [], 'quick': [('source', operator.itemgetter(2)), ('event_metadata', operator.itemgetter(4)), ('event_type', operator.itemgetter(1)), ('workflows_executed', operator.itemgetter(6)), ('error_message', operator.itemgetter(8)), ('event_data', operator.itemgetter(3)), ('id', operator.itemgetter(0)), ('triggers_matched', operator.itemgetter(5)), ('success', operator.itemgetter(7)), ('processed_at', operator.itemgetter(9))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [], 'primary_key_getter': None}'
DEBUG:sqlalchemy.engine.Engine:Row (3, 'file_upload', 'web-client-upload', {'filename': 'test_e2e_upload.pdf', 'file_size': 1678, 'content_type': 'application/pdf', 'user_id': 1, 'is_public': False}, None, 0, 0, True, None, datetime.datetime(2025, 11, 19, 23, 3, 56))
INFO:backend.crud.workflow_triggers:‚úÖ Event log created: 3
ERROR:backend.crud.workflow_triggers:‚ùå Error creating event log: 'EventLog' object has no attribute 'created_at'
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000029C2612BC40> rollback-on-return
INFO:     127.0.0.1:60809 - "POST /api/documents/upload-with-visibility/ HTTP/1.1" 200 OK
INFO:backend.routers.plugins_router:Plugin registrato: PDF Folder Monitor (pdf-monitor-001) su http://localhost:8001
INFO:     127.0.0.1:60814 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 3415
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:51642 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:55980 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:51307 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:56845 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:55452 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:58963 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:56449 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend\services\trigger_service.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [16668]
INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [27944]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x0000026EE227FB50>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00027s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x26ebefc16a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('name', operator.itemgetter(3)), ('id', operator.itemgetter(0)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('username', operator.itemgetter(1)), ('email', operator.itemgetter(2)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x26ebead9810; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> rollback-on-return
INFO:     Application startup complete.
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 1075
INFO:backend.routers.plugins_router:Plugin registrato: PDF Folder Monitor (pdf-monitor-001) su http://localhost:8001
INFO:     127.0.0.1:59730 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 55.75s ago] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: User 'admin' found in database. ID: 1. Proceeding to verify password.
DEBUG:backend.services.user_service:USER_SERVICE: Verifying password for user 'admin'
WARNING:passlib.handlers.bcrypt:(trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
DEBUG:passlib.handlers.bcrypt:detected 'bcrypt' backend, version '<unknown>'
DEBUG:passlib.handlers.bcrypt:'bcrypt' backend lacks $2$ support, enabling workaround
INFO:backend.services.user_service:USER_SERVICE: User 'admin' authenticated successfully.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> rollback-on-return
INFO:     127.0.0.1:59751 - "POST /auth/token/local HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdW...
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token estratto: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...1Eiqs2np6Q (lunghezza: 191)
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token decodificato con successo. Payload: {'sub': 'admin', 'name': 'Administrator', 'role': 'admin', 'user_id': 1, 'exp': 1763597578}
INFO:vectorstore_client:VectorstoreServiceClient inizializzato con URL: http://localhost:8090
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8090
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 216
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health/ HTTP/1.1" 200 15
INFO:vectorstore_client:Connessione a VectorstoreService stabilita: http://localhost:8090
ERROR:backend.core.rag_engine:Errore ingest_pdf per file 'test_e2e_upload.pdf': 'VectorstoreServiceClient' object has no attribute 'add_documents'
Traceback (most recent call last):
  File "C:\PramaIA\PramaIAServer\backend\core\rag_engine.py", line 76, in ingest_pdf
    response = client.add_documents(collection_name, doc_texts, metadatas)
               ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VectorstoreServiceClient' object has no attribute 'add_documents'. Did you mean: 'add_document'?
INFO:backend.services.document_service:Attempting to save metadata for: test_e2e_upload.pdf, owner: 1, size: 1678 bytes, is_public: False
DEBUG:backend.services.document_service:DATA_INDEX_PATH is: C:\PramaIA\PramaIAServer\backend\db\index.json
INFO:backend.services.document_service:Loaded 7 existing entries from C:\PramaIA\PramaIAServer\backend\db\index.json.
INFO:backend.services.document_service:Removed existing entry for 'test_e2e_upload.pdf' during deduplication.
INFO:backend.services.document_service:Appended new entry for 'test_e2e_upload.pdf'. Total entries now: 7.
INFO:backend.services.document_service:Successfully wrote 7 entries to C:\PramaIA\PramaIAServer\backend\db\index.json.
INFO:backend.routers.event_trigger_system:Ricevuto evento file_upload da web-client-upload [ID: 7795915f-bb28-4701-8467-5ac6f2e4aab8]
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.crud.workflow_triggers:üìä Accesso al DB per trigger: C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üìä Percorso completo DB: sqlite:///C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üîç Query per trigger: SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
INFO:sqlalchemy.engine.Engine:[generated in 0.00017s] ()
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'name', 'event_type', 'source', 'workflow_id', 'target_node_id', 'conditions', 'active', 'created_at', 'updated_at')
DEBUG:sqlalchemy.engine.Engine:Row ('2cf4add5-5fa5-485f-a8b1-549557b14955', 'Trigger Aggiunta PDF', 'pdf_file_added', 'pdf-monitor-event-source', 'wf_bd11290f923b', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 16, 21, 11, 1, 755526))
INFO:backend.crud.workflow_triggers:üîé Trigger 2cf4add5-5fa5-485f-a8b1-549557b14955: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a', 'Trigger Eliminazione PDF', 'document_file_deleted', 'pdf-monitor-event-source', 'wf_b32ead12131c', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 36, 44, 462354))
INFO:backend.crud.workflow_triggers:üîé Trigger 11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('f052f3b6-3bf2-4eda-bb2f-62486ee52893', 'Trigger Aggiornamento PDF', 'document_file_modified', 'pdf-monitor-event-source', 'wf_055bf5029833', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 37, 3, 623911))
INFO:backend.crud.workflow_triggers:üîé Trigger f052f3b6-3bf2-4eda-bb2f-62486ee52893: conditions={} (tipo: dict)
INFO:backend.crud.workflow_triggers:‚úÖ Trovati 3 trigger nel database
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 1: ID=2cf4add5-5fa5-485f-a8b1-549557b14955, Nome=Trigger Aggiunta PDF, Tipo=pdf_file_added, Workflow=wf_bd11290f923b
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 2: ID=11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a, Nome=Trigger Eliminazione PDF, Tipo=document_file_deleted, Workflow=wf_b32ead12131c
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 3: ID=f052f3b6-3bf2-4eda-bb2f-62486ee52893, Nome=Trigger Aggiornamento PDF, Tipo=document_file_modified, Workflow=wf_055bf5029833
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop nodes
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes setup primary join workflows.workflow_id = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes synchronize pairs [(workflows.workflow_id => workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes local/remote pairs [(workflows.workflow_id / workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes remote columns [workflow_nodes.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.nodes lazy loading clause :param_1 = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop connections
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections setup primary join workflows.workflow_id = workflow_connections.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections synchronize pairs [(workflows.workflow_id => workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections local/remote pairs [(workflows.workflow_id / workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections remote columns [workflow_connections.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.connections lazy loading clause :param_1 = workflow_connections.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop executions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions setup primary join workflows.workflow_id = workflow_executions.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions synchronize pairs [(workflows.workflow_id => workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions local/remote pairs [(workflows.workflow_id / workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions remote columns [workflow_executions.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.executions lazy loading clause :param_1 = workflow_executions.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop created_by
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop is_public
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop assigned_groups
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop tags
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop category
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop priority
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop color
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop view_state
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow setup primary join workflows.workflow_id = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow synchronize pairs [(workflows.workflow_id => workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow local/remote pairs [(workflow_nodes.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow local columns [workflow_nodes.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowNode.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop node_type
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop config
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop position
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop width
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop height
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop resizable
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop icon
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop color
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow setup primary join workflows.workflow_id = workflow_connections.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow synchronize pairs [(workflows.workflow_id => workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow local/remote pairs [(workflow_connections.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow local columns [workflow_connections.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowConnection.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop from_node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop to_node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop from_port
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop to_port
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow setup primary join workflows.workflow_id = workflow_executions.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow synchronize pairs [(workflows.workflow_id => workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow local/remote pairs [(workflow_executions.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow local columns [workflow_executions.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowExecution.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop execution_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop status
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop input_data
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop output_data
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop error_message
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop started_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop completed_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop execution_time_ms
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop event_type
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop source
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop conditions
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop active
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_type
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop source
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_data
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_metadata
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop triggers_matched
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop workflows_executed
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop success
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop error_message
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop processed_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) _post_configure_properties() complete
INFO:sqlalchemy.engine.Engine:INSERT INTO event_logs (event_type, source, event_data, triggers_matched, workflows_executed, success, error_message) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id, processed_at
INFO:sqlalchemy.engine.Engine:[generated in 0.00020s] ('file_upload', 'web-client-upload', '{"filename": "test_e2e_upload.pdf", "file_size": 1678, "content_type": "application/pdf", "user_id": 1, "is_public": false}', 0, 0, 1, None)
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'processed_at')
DEBUG:sqlalchemy.engine.Engine:Row (4, datetime.datetime(2025, 11, 19, 23, 13, 4))
INFO:sqlalchemy.engine.Engine:COMMIT
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> rollback-on-return
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[EventLog(event_logs)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT event_logs.id, event_logs.event_type, event_logs.source, event_logs.event_data, event_logs.event_metadata, event_logs.triggers_matched, event_logs.workflows_executed, event_logs.success, event_logs.error_message, event_logs.processed_at
FROM event_logs
WHERE event_logs.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00021s] (4,)
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'event_type', 'source', 'event_data', 'event_metadata', 'triggers_matched', 'workflows_executed', 'success', 'error_message', 'processed_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x26ee115d450; EventLog>)' on path 'ORM Path[Mapper[EventLog(event_logs)]]' to '{'cached_populators': {'new': [], 'quick': [('source', operator.itemgetter(2)), ('event_metadata', operator.itemgetter(4)), ('event_type', operator.itemgetter(1)), ('workflows_executed', operator.itemgetter(6)), ('error_message', operator.itemgetter(8)), ('event_data', operator.itemgetter(3)), ('id', operator.itemgetter(0)), ('triggers_matched', operator.itemgetter(5)), ('success', operator.itemgetter(7)), ('processed_at', operator.itemgetter(9))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [], 'primary_key_getter': None}'
DEBUG:sqlalchemy.engine.Engine:Row (4, 'file_upload', 'web-client-upload', {'filename': 'test_e2e_upload.pdf', 'file_size': 1678, 'content_type': 'application/pdf', 'user_id': 1, 'is_public': False}, None, 0, 0, True, None, datetime.datetime(2025, 11, 19, 23, 13, 4))
INFO:backend.crud.workflow_triggers:‚úÖ Event log created: 4
ERROR:backend.crud.workflow_triggers:‚ùå Error creating event log: 'EventLog' object has no attribute 'created_at'
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x0000026EE227FB50> rollback-on-return
INFO:     127.0.0.1:59756 - "POST /api/documents/upload-with-visibility/ HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 3454
INFO:backend.routers.plugins_router:Plugin gi√† registrato: PDF Folder Monitor (pdf-monitor-001)
INFO:     127.0.0.1:57684 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend\routers\event_trigger_system.py'. Reloading...
 INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [27944]
INFO:backend.utils.logging_service:Modulo pramaialog importato con successo
INFO:backend.utils.logging_service:PramaIALogger inizializzato con successo. Host: http://localhost:8081
C:\PramaIA\PramaIAServer\backend\core\rag_chains_prompts.py:36: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 1.0. Use :meth:`~RunnableSequence, e.g., `prompt | llm`` instead.
  classification_chain = LLMChain(
C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\pydantic\_internal\_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:backend.routers.protected_router:--- protected_router.py: Modulo in fase di caricamento ---
INFO:backend.routers.protected_router:--- protected_router.py: Istanza APIRouter creata ---
[IMPORT] backend/routers/workflow_router.py loaded
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.routers.pdk_router:üîå PDK Server configurato su: http://localhost:3001
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: Sistema
INFO:backend.core.event_sources_registry:Caricata sorgente built-in: API Webhook
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-EventSources non trovata
INFO:backend.core.event_sources_registry:Directory sorgenti PramaIA-PDK/event-sources non trovata
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:backend.core.rag_vectorstore:ChromaDB client initialized. Collection 'prama_documents' ensured.
DEBUG:backend.main:Avvio di main.py in modalit√† DEBUG forzato su tutti i moduli...
INFO:backend.main:Istanza FastAPI creata.
INFO:backend.main:üåç Configurazione CORS - Origini consentite: ['http://localhost:3000', 'http://localhost:3000', 'http://127.0.0.1:3000', '*']
INFO:backend.main:üåç FRONTEND_URL configurato: http://localhost:3000
INFO:backend.main:‚úÖ CORSMiddleware aggiunto con successo.
INFO:backend.main:Inclusione routers...
INFO:backend.main:auth_router incluso.
INFO:backend.main:documents_router incluso.
INFO:backend.main:chat_router incluso.
INFO:backend.main:sessions_router incluso.
INFO:backend.main:protected_router incluso.
INFO:backend.main:dashboard_router incluso.
INFO:backend.main:admin_router incluso.
INFO:backend.main:admin_panel_router incluso.
INFO:backend.main:usage_router incluso.
INFO:backend.main:update_prompt_router incluso.
INFO:backend.main:llm_router incluso.
INFO:backend.main:plugins_router incluso.
INFO:backend.main:pdf_monitor_compatibility_router incluso.
INFO:backend.main:pdk_router incluso.
INFO:backend.main:workflow_triggers_router incluso.
INFO:backend.main:workflow_router incluso.
INFO:backend.main:event_trigger_router incluso.
INFO:backend.main:event_sources_router incluso.
INFO:backend.main:folder_sync_router incluso.
INFO:backend.main:documents_compatibility_router incluso.
INFO:backend.main:Tutti i router inclusi con successo.
INFO:backend.main:Fine configurazione di main.py.
INFO:     Started server process [25660]
INFO:     Waiting for application startup.
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop sessions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local/remote pairs [(users.id / chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions remote columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions local columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:User.sessions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:User.sessions lazy loading clause :param_1 = chat_sessions.user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop username
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop email
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop hashed_password
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop role
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(User|users) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop owner
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup primary join users.id = chat_sessions.user_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner synchronize pairs [(users.id => chat_sessions.user_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local/remote pairs [(chat_sessions.user_id / users.id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner remote columns [users.id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner local columns [chat_sessions.user_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:ChatSession.owner relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner lazy loading clause users.id = :param_1
INFO:sqlalchemy.orm.strategies.LazyLoader:ChatSession.owner will use Session.get() to optimize instance loads
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop title
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop system_prompt
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(ChatSession|chat_sessions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_id
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop session_uuid
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop prompt
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop answer
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop tokens
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) initialize prop timestamp
INFO:sqlalchemy.orm.mapper.Mapper:(Message|messages) _post_configure_properties() complete
DEBUG:sqlalchemy.pool.impl.QueuePool:Created new connection <sqlite3.Connection object at 0x00000215C10EFC40>
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[User(users)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00023s] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x2159de2d6a0; User>)' on path 'ORM Path[Mapper[User(users)]]' to '{'cached_populators': {'new': [], 'quick': [('id', operator.itemgetter(0)), ('name', operator.itemgetter(3)), ('user_id', operator.itemgetter(5)), ('is_active', operator.itemgetter(7)), ('updated_at', operator.itemgetter(9)), ('email', operator.itemgetter(2)), ('username', operator.itemgetter(1)), ('hashed_password', operator.itemgetter(4)), ('role', operator.itemgetter(6)), ('created_at', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [<_RelationshipDeclared at 0x2159d950af0; sessions>], 'primary_key_getter': operator.itemgetter(slice(0, 1, None))}'
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: Default admin user 'admin' already exists.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> rollback-on-return
INFO:     Application startup complete.
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): us.i.posthog.com:443
DEBUG:urllib3.connectionpool:https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 1075
DEBUG:backend.services.user_service:USER_SERVICE: Querying for username: 'admin'
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.name AS users_name, users.hashed_password AS users_hashed_password, users.user_id AS users_user_id, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.updated_at AS users_updated_at
FROM users
WHERE users.username = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 4.854s ago] ('admin', 1, 0)
DEBUG:sqlalchemy.engine.Engine:Col ('users_id', 'users_username', 'users_email', 'users_name', 'users_hashed_password', 'users_user_id', 'users_role', 'users_is_active', 'users_created_at', 'users_updated_at')
DEBUG:sqlalchemy.engine.Engine:Row (1, 'admin', 'admin@example.com', 'Administrator', '$2b$12$R.wjU5PxcXVAaaNhBZvB/uGJ519x0Xk4traLA8wxCItTSkS6m54Qi', 'ee38533e-89ed-4551-9e56-de93ce3d2fb3', 'admin', True, None, None)
DEBUG:backend.services.user_service:USER_SERVICE: User 'admin' found in DB.
INFO:backend.services.user_service:USER_SERVICE: User 'admin' found in database. ID: 1. Proceeding to verify password.
DEBUG:backend.services.user_service:USER_SERVICE: Verifying password for user 'admin'
WARNING:passlib.handlers.bcrypt:(trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\fabmi\AppData\Local\Programs\Python\Python313\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
DEBUG:passlib.handlers.bcrypt:detected 'bcrypt' backend, version '<unknown>'
DEBUG:passlib.handlers.bcrypt:'bcrypt' backend lacks $2$ support, enabling workaround
INFO:backend.services.user_service:USER_SERVICE: User 'admin' authenticated successfully.
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> rollback-on-return
INFO:     127.0.0.1:60569 - "POST /auth/token/local HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdW...
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token estratto: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...gw6--5mZok (lunghezza: 191)
INFO:backend.auth.dependencies:üîç AUTH DEBUG: Token decodificato con successo. Payload: {'sub': 'admin', 'name': 'Administrator', 'role': 'admin', 'user_id': 1, 'exp': 1763597638}
INFO:vectorstore_client:VectorstoreServiceClient inizializzato con URL: http://localhost:8090
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8090
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 216
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health HTTP/1.1" 307 0
DEBUG:urllib3.connectionpool:http://localhost:8090 "GET /health/ HTTP/1.1" 200 15
INFO:vectorstore_client:Connessione a VectorstoreService stabilita: http://localhost:8090
ERROR:backend.core.rag_engine:Errore ingest_pdf per file 'test_e2e_upload.pdf': 'VectorstoreServiceClient' object has no attribute 'add_documents'
Traceback (most recent call last):
  File "C:\PramaIA\PramaIAServer\backend\core\rag_engine.py", line 76, in ingest_pdf
    response = client.add_documents(collection_name, doc_texts, metadatas)
               ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VectorstoreServiceClient' object has no attribute 'add_documents'. Did you mean: 'add_document'?
INFO:backend.services.document_service:Attempting to save metadata for: test_e2e_upload.pdf, owner: 1, size: 1678 bytes, is_public: False
DEBUG:backend.services.document_service:DATA_INDEX_PATH is: C:\PramaIA\PramaIAServer\backend\db\index.json
INFO:backend.services.document_service:Loaded 7 existing entries from C:\PramaIA\PramaIAServer\backend\db\index.json.
INFO:backend.services.document_service:Removed existing entry for 'test_e2e_upload.pdf' during deduplication.
INFO:backend.services.document_service:Appended new entry for 'test_e2e_upload.pdf'. Total entries now: 7.
INFO:backend.services.document_service:Successfully wrote 7 entries to C:\PramaIA\PramaIAServer\backend\db\index.json.
INFO:backend.routers.event_trigger_system:üü¢ [process_generic_event] CALLED! event_type=file_upload, source=web-client-upload, event_id=b8c41ce9-1672-4e54-a3ce-7f242f8a431d
INFO:backend.routers.event_trigger_system:Ricevuto evento file_upload da web-client-upload [ID: b8c41ce9-1672-4e54-a3ce-7f242f8a431d]
INFO:backend.routers.event_trigger_system:üü° [process_generic_event] About to call TriggerService.process_event()...
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
DEBUG:httpx:load_ssl_context verify=True cert=None trust_env=True http2=False
DEBUG:httpx:load_verify_locations cafile='C:\\Users\\fabmi\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\certifi\\cacert.pem'
INFO:backend.llm.ollama:ü¶ô OllamaProvider inizializzato
INFO:backend.crud.workflow_triggers:üìä Accesso al DB per trigger: C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üìä Percorso completo DB: sqlite:///C:\PramaIA\PramaIAServer\backend\db\database.db
INFO:backend.crud.workflow_triggers:üîç Query per trigger: SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT workflow_triggers.id, workflow_triggers.name, workflow_triggers.event_type, workflow_triggers.source, workflow_triggers.workflow_id, workflow_triggers.target_node_id, workflow_triggers.conditions, workflow_triggers.active, workflow_triggers.created_at, workflow_triggers.updated_at
FROM workflow_triggers
INFO:sqlalchemy.engine.Engine:[generated in 0.00020s] ()
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'name', 'event_type', 'source', 'workflow_id', 'target_node_id', 'conditions', 'active', 'created_at', 'updated_at')
DEBUG:sqlalchemy.engine.Engine:Row ('2cf4add5-5fa5-485f-a8b1-549557b14955', 'Trigger Aggiunta PDF', 'pdf_file_added', 'pdf-monitor-event-source', 'wf_bd11290f923b', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 16, 21, 11, 1, 755526))
INFO:backend.crud.workflow_triggers:üîé Trigger 2cf4add5-5fa5-485f-a8b1-549557b14955: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a', 'Trigger Eliminazione PDF', 'document_file_deleted', 'pdf-monitor-event-source', 'wf_b32ead12131c', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 36, 44, 462354))
INFO:backend.crud.workflow_triggers:üîé Trigger 11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a: conditions={} (tipo: dict)
DEBUG:sqlalchemy.engine.Engine:Row ('f052f3b6-3bf2-4eda-bb2f-62486ee52893', 'Trigger Aggiornamento PDF', 'document_file_modified', 'pdf-monitor-event-source', 'wf_055bf5029833', 'pdf_input_validator', '{}', True, datetime.datetime(2025, 10, 8, 20, 27, 37), datetime.datetime(2025, 11, 19, 7, 37, 3, 623911))
INFO:backend.crud.workflow_triggers:üîé Trigger f052f3b6-3bf2-4eda-bb2f-62486ee52893: conditions={} (tipo: dict)
INFO:backend.crud.workflow_triggers:‚úÖ Trovati 3 trigger nel database
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 1: ID=2cf4add5-5fa5-485f-a8b1-549557b14955, Nome=Trigger Aggiunta PDF, Tipo=pdf_file_added, Workflow=wf_bd11290f923b
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 2: ID=11f4a284-9ac3-4fe7-bbe3-ca90d0c22f7a, Nome=Trigger Eliminazione PDF, Tipo=document_file_deleted, Workflow=wf_b32ead12131c
INFO:backend.crud.workflow_triggers:‚úÖ Trigger 3: ID=f052f3b6-3bf2-4eda-bb2f-62486ee52893, Nome=Trigger Aggiornamento PDF, Tipo=document_file_modified, Workflow=wf_055bf5029833
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop nodes
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes setup primary join workflows.workflow_id = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes synchronize pairs [(workflows.workflow_id => workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes local/remote pairs [(workflows.workflow_id / workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes remote columns [workflow_nodes.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.nodes relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.nodes lazy loading clause :param_1 = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop connections
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections setup primary join workflows.workflow_id = workflow_connections.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections synchronize pairs [(workflows.workflow_id => workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections local/remote pairs [(workflows.workflow_id / workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections remote columns [workflow_connections.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.connections relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.connections lazy loading clause :param_1 = workflow_connections.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop executions
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions setup primary join workflows.workflow_id = workflow_executions.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions synchronize pairs [(workflows.workflow_id => workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions local/remote pairs [(workflows.workflow_id / workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions remote columns [workflow_executions.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions local columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:Workflow.executions relationship direction RelationshipDirection.ONETOMANY
INFO:sqlalchemy.orm.strategies.LazyLoader:Workflow.executions lazy loading clause :param_1 = workflow_executions.workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop created_by
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop is_active
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop is_public
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop assigned_groups
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop tags
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop category
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop priority
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop color
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) initialize prop view_state
INFO:sqlalchemy.orm.mapper.Mapper:(Workflow|workflows) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow setup primary join workflows.workflow_id = workflow_nodes.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow synchronize pairs [(workflows.workflow_id => workflow_nodes.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow local/remote pairs [(workflow_nodes.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow local columns [workflow_nodes.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowNode.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowNode.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop node_type
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop config
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop position
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop width
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop height
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop resizable
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop icon
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop color
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowNode|workflow_nodes) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow setup primary join workflows.workflow_id = workflow_connections.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow synchronize pairs [(workflows.workflow_id => workflow_connections.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow local/remote pairs [(workflow_connections.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow local columns [workflow_connections.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowConnection.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowConnection.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop from_node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop to_node_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop from_port
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop to_port
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowConnection|workflow_connections) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop workflow
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow setup primary join workflows.workflow_id = workflow_executions.workflow_id
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow setup secondary join None
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow synchronize pairs [(workflows.workflow_id => workflow_executions.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow secondary synchronize pairs []
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow local/remote pairs [(workflow_executions.workflow_id / workflows.workflow_id)]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow remote columns [workflows.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow local columns [workflow_executions.workflow_id]
INFO:sqlalchemy.orm.relationships.RelationshipProperty:WorkflowExecution.workflow relationship direction RelationshipDirection.MANYTOONE
INFO:sqlalchemy.orm.strategies.LazyLoader:WorkflowExecution.workflow lazy loading clause workflows.workflow_id = :param_1
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop execution_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop user_id
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop status
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop input_data
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop output_data
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop error_message
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop started_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop completed_at
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) initialize prop execution_time_ms
INFO:sqlalchemy.orm.mapper.Mapper:(WorkflowExecution|workflow_executions) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop name
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop description
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop event_type
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop source
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop workflow_id
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop conditions
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop active
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop created_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) initialize prop updated_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventTrigger|event_triggers) _post_configure_properties() complete
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) _post_configure_properties() started
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop id
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_type
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop source
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_data
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop event_metadata
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop triggers_matched
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop workflows_executed
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop success
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop error_message
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) initialize prop processed_at
INFO:sqlalchemy.orm.mapper.Mapper:(EventLog|event_logs) _post_configure_properties() complete
INFO:sqlalchemy.engine.Engine:INSERT INTO event_logs (event_type, source, event_data, triggers_matched, workflows_executed, success, error_message) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id, processed_at
INFO:sqlalchemy.engine.Engine:[generated in 0.00040s] ('file_upload', 'web-client-upload', '{"filename": "test_e2e_upload.pdf", "file_size": 1678, "content_type": "application/pdf", "user_id": 1, "is_public": false}', 0, 0, 1, None)
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'processed_at')
DEBUG:sqlalchemy.engine.Engine:Row (5, datetime.datetime(2025, 11, 19, 23, 14, 4))
INFO:sqlalchemy.engine.Engine:COMMIT
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> rollback-on-return
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> checked out from pool
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
DEBUG:sqlalchemy.orm.path_registry:set 'memoized_setups' on path 'ORM Path[Mapper[EventLog(event_logs)]]' to '{}'
INFO:sqlalchemy.engine.Engine:SELECT event_logs.id, event_logs.event_type, event_logs.source, event_logs.event_data, event_logs.event_metadata, event_logs.triggers_matched, event_logs.workflows_executed, event_logs.success, event_logs.error_message, event_logs.processed_at
FROM event_logs
WHERE event_logs.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] (5,)
DEBUG:sqlalchemy.engine.Engine:Col ('id', 'event_type', 'source', 'event_data', 'event_metadata', 'triggers_matched', 'workflows_executed', 'success', 'error_message', 'processed_at')
DEBUG:sqlalchemy.orm.path_registry:set '('getters', <Mapper at 0x215bffc5450; EventLog>)' on path 'ORM Path[Mapper[EventLog(event_logs)]]' to '{'cached_populators': {'new': [], 'quick': [('event_data', operator.itemgetter(3)), ('id', operator.itemgetter(0)), ('triggers_matched', operator.itemgetter(5)), ('success', operator.itemgetter(7)), ('processed_at', operator.itemgetter(9)), ('source', operator.itemgetter(2)), ('event_metadata', operator.itemgetter(4)), ('event_type', operator.itemgetter(1)), ('workflows_executed', operator.itemgetter(6)), ('error_message', operator.itemgetter(8))], 'deferred': [], 'expire': [], 'existing': [], 'eager': []}, 'todo': [], 'primary_key_getter': None}'
DEBUG:sqlalchemy.engine.Engine:Row (5, 'file_upload', 'web-client-upload', {'filename': 'test_e2e_upload.pdf', 'file_size': 1678, 'content_type': 'application/pdf', 'user_id': 1, 'is_public': False}, None, 0, 0, True, None, datetime.datetime(2025, 11, 19, 23, 14, 4))
INFO:backend.crud.workflow_triggers:‚úÖ Event log created: 5
ERROR:backend.crud.workflow_triggers:‚ùå Error creating event log: 'EventLog' object has no attribute 'created_at'
INFO:sqlalchemy.engine.Engine:ROLLBACK
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> being returned to pool
DEBUG:sqlalchemy.pool.impl.QueuePool:Connection <sqlite3.Connection object at 0x00000215C10EFC40> rollback-on-return
INFO:backend.routers.event_trigger_system:üü° [process_generic_event] TriggerService.process_event() returned: {'success': True, 'triggers_matched': 0, 'workflows_executed': 0, 'results': []}
INFO:     127.0.0.1:60575 - "POST /api/documents/upload-with-visibility/ HTTP/1.1" 200 OK
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8081
DEBUG:urllib3.connectionpool:http://localhost:8081 "POST /api/logs/batch HTTP/1.1" 201 3454
INFO:backend.routers.plugins_router:Plugin registrato: PDF Folder Monitor (pdf-monitor-001) su http://localhost:8001
INFO:     127.0.0.1:59396 - "POST /api/document-monitor/clients/register HTTP/1.1" 200 OK
